# 更新日志

所有显著的变更都会记录在此文档中。此项目遵循 [语义化版本控制](https://semver.org/spec/v2.0.0.html)。

## [2.3.0] - 2025-05-21

### 新增
- 新增下载器：“迅雷”，支持调用迅雷-远程设备进行下载。（可通过菜单栏点击“版本号”，在窗口中点击“使用帮助”链接访问配置文档）
- 增加使用帮助和问题反馈渠道。可通过点击左下角“版本号”弹出程序信息，点击“使用帮助”链接访问配置文档，在配置文档页面中通过问题反馈渠道进行反馈。

### 优化
- 优化系统仪表中“系统进程”模块运行时长的计算逻辑，超过24小时，将显示为“天”+“小时”。
- 优化目录监控服务中下载文件转移时提取视频质量的处理逻辑，统一视频质量后缀为p（逐行扫描）例如：1080p、2160p。

## [2.2.4] - 2025-05-19

### 修复
- 修复“观影”站点建立索引失败的问题（站点策略更新需要登录后才有权限进行搜索、下载等操作）。

## [2.2.3] - 2025-05-16

### 说明
- 修复较为严重的BUG，在特定情况下该BUG会引起程序崩溃无法使用，建议所有用户安装更新。可通过在线更新或拉取最新Docker镜像更新。

### 修复
- 修复检查订阅时，如果已入库的剧集只有1集时，程序读取的数据是整数而不是字符串，导致程序异常崩溃的问题。
- 修复进入“电视剧”库时，如果已入库剧集存在只有1集的情况时页面显示服务器错误，无法进入电视剧库的问题。

### 优化
- 优化下载管理页面下载任务状态解析，更新常用状态及对应文字提示。

## [2.2.2] - 2025-05-15

### 修复
- 扫描媒体库时，媒体文件标题与NFO文件中标题不一致时，会判定为不同的影片，导致同一部影片在媒体库中存在重复数据的问题。

### 优化
- 扫描媒体库和下载文件转移支持ISO文件格式。
- 优化电视节目下载匹配逻辑，缺失集数和资源索引结果进行由低到高匹配，尽可能避免下载到重复集。

## [2.2.1] - 2025-05-14

### 修复
- 修复媒体目录中不存在NFO文件时扫描不到电影的问题。

### 优化
- 系统设置页面优化，增加设置项提示文字。

## [2.2.0] - 2025-05-13

### 新增
- 新增多站点功能，新增并适配：观影、不太灵影视 两个站点。目前支持私有BT站（需注册账号）：高清剧集网、高清影视之家。免费站点：观影（需注册账号）、不太灵影视

### 修复
- 修复系统仪表读取系统进程时因为某些进程可能没有命令行参数（cmdline），因此psutil返回的cmdline值为None。导致调用len(cmdline) 时抛出了TypeError 导致系统进程列表获取失败的问题。
- 修复热门推荐中“热门剧集”的订阅错误，剧集被错误的当成电影进行订阅。

### 修改
- 修改资源搜索逻辑，将搜索结果保存在索引文件中，由下载程序直接调用搜索结果。
- 修改热门推荐中“订阅”按钮的状态检查，如果影片已订阅或已入库，则改变按钮状态为已订阅或已入库，避免重复订阅。

### 优化
- 优化文件转移时检查现有媒体库文件，如果已存在相同剧集或电影，则删除现有文件并转移新文件，避免媒体库中重复多个版本文件。

## [2.1.3] - 2025-04-30

### 说明
- 本次更新为五一节前最后一次更新，计划节后将开始开发免费站点功能，计划适配：观影、不太灵影视 两个站点。

### 优化
- 正在订阅数据插入数据库时加入豆瓣ID到数据库中，便于后续资源搜索时使用豆瓣ID进行搜索（计划用于免费站点）。

### 修复
- 修复从服务控制中手动运行服务后运行日志被删除的问题。

## [2.1.2] - 2025-04-29

### 优化
- 在线升级时，加载指示器遮罩层被升级窗口遮挡的问题。
- 使用qbittorrent下载器时，任务暂停状态显示为未知的问题。
- 优化Github代理加速，智能选择响应时间最快的代理站点，提高在线升级时拉取新版本的成功率。

## [2.1.1] - 2025-04-27

### 优化
- 优化版本号读取逻辑，版本号不再直接写在程序代码中，通过读取版本文件获取版本号。
- 优化版本统计报告，程序启动后将随机生成一个UUID，并向服务器报告当前程序的UUID和当前版本号（仅用于统计使用情况，程序不会收集任何用户个人数据）。

### 修复
- 修复系统仪表CPU、内存、存储使用情况显示，超80%以上使用率时仪表颜色变为橙色，超90%以上使用率时仪表颜色变为红色，提升用户体验。

## [2.1.0] - 2025-04-24

### 优化
- 调整WEB UI界面样式，页面观感更加美观，提升用户体验。

### 修复
- 修复一些已知问题，提升用户体验。

### 新增
- 上线系统仪表盘统计功能，支持显示当前媒体库中的媒体统计，以及系统硬件资源使用情况、系统进程显示、下载器实时速率显示等。
- 上线TMDB热门推荐功能，支持从推荐中直接添加订阅。（此功能依赖TMDB API接口，网络不可达或API密钥无效时无法正常使用。）

## [2.0.5] - 2025-04-17

### 优化
- 优化部分页面显示效果，提升用户体验。
- 优化在线升级功能处理逻辑，提升用户体验。

## [2.0.4] - 2025-04-16

### 新增
- 新增在线升级功能，支持在线检查程序更新并且进行在线升级（依赖Github Api接口，网络不可达会导致检查更新失败）。

## [2.0.3] - 2025-04-15

### 优化
- 优化下载器管理功能，使用qbittorrent-api和transmission-rpc python库，并且统一前端页面api接口调用，支持qbittorrent和transmission下载器。

### 修复
- 修复一些已知问题，提升用户体验。

### 新增
- 新增下载器管理功能支持用户名密码认证，在系统设置中配置下载器用户名和密码即可（qbittorrent一般需要登录，transmission一般不需要；如果没有用户名密码时配置项保持默认或填写为空即可）。

## [2.0.2] - 2025-04-11

### 优化
- 进一步优化查找种子下载链接的匹配逻辑，增加显式等待和重试机制，减少 `stale element reference` 异常的发生，提高下载成功的概率。

### 修复
- 修复一些已知问题。

### 升级
- 升级Google Chrome浏览器和ChromeDriver版本到135.0.7049.84。

## [2.0.1] - 2025-04-10

### 优化
- 优化查找种子下载链接的匹配逻辑。
- 优化一些其他细节。

## [2.0.0] - 2025-04-08

### 说明
- 本次版本为v2.0.0，基于mediamaster-chromedriver 1.8.1版本改版并重新构建大部分代码，优化了部分功能。

### 注意事项
- 本次更新涉及数据库结构变更、配置文件变更，无法与之前版本兼容以及无损更新，需要重新进行系统配置。

[2.0.0]: https://github.com/smysong/mediamaster-v2/releases/tag/v2.0.0
[2.0.1]: https://github.com/smysong/mediamaster-v2/releases/tag/v2.0.1
[2.0.2]: https://github.com/smysong/mediamaster-v2/releases/tag/v2.0.2
[2.0.3]: https://github.com/smysong/mediamaster-v2/releases/tag/v2.0.3
[2.0.4]: https://github.com/smysong/mediamaster-v2/releases/tag/v2.0.4
[2.0.5]: https://github.com/smysong/mediamaster-v2/releases/tag/v2.0.5
[2.1.0]: https://github.com/smysong/mediamaster-v2/releases/tag/v2.1.0
[2.1.1]: https://github.com/smysong/mediamaster-v2/releases/tag/v2.1.1
[2.1.2]: https://github.com/smysong/mediamaster-v2/releases/tag/v2.1.2
[2.1.3]: https://github.com/smysong/mediamaster-v2/releases/tag/v2.1.3
[2.2.0]: https://github.com/smysong/mediamaster-v2/releases/tag/v2.2.0
[2.2.1]: https://github.com/smysong/mediamaster-v2/releases/tag/v2.2.1
[2.2.2]: https://github.com/smysong/mediamaster-v2/releases/tag/v2.2.2
[2.2.3]: https://github.com/smysong/mediamaster-v2/releases/tag/v2.2.3
[2.2.4]: https://github.com/smysong/mediamaster-v2/releases/tag/v2.2.4
[2.3.0]: https://github.com/smysong/mediamaster-v2/releases/tag/v2.3.0